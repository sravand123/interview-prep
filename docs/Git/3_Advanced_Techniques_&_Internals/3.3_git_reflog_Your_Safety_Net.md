---
topic: Git
section: Advanced Techniques & Internals
subtopic: git reflog: Your Safety Net
level: Advanced
---

## git reflog: Your Safety Net
### Core Concepts

*   **`git reflog`:** A local history of your repository's actions. It records updates to the tips of branches and other references within your repository.
*   **Safety Net:** Primarily used to recover from mistakes, such as accidentally deleting branches, losing commits, or reverting to a previous state.
*   **Local Operation:** `reflog` is specific to your local repository copy and is not shared during `git push` or `git pull`.

### Key Details & Nuances

*   **What it Logs:**
    *   Committing
    *   Branch switching (`checkout`, `switch`)
    *   Branch creation/deletion
    *   Rebasing
    *   Resetting
    *   Amending commits
    *   Merging
    *   Stashing
*   **Reference:** `HEAD` is the most common reference tracked by `reflog`.
*   **Entries:** Each entry has an **action** (e.g., `commit`, `checkout`) and a **commit hash**.
*   **Expiration:** Reflog entries expire after a default period (typically 90 days for reachable commits, 30 days for unreachable commits). This can be configured.
*   **`git reflog show`:** Displays the reflog entries.
    *   `git reflog show --decorate`: Shows decorated references.
    *   `git reflog show --date=relative`: Shows relative dates.
*   **Recovering Commits:** You can use `git cherry-pick <commit-hash>` or `git checkout <commit-hash>` to restore lost work.
*   **`git reset --hard <commit-hash>`:** Can be used to revert the current branch to a previous state.
*   **`git fsck`:** Useful for finding dangling commits that `reflog` might help recover.

### Practical Examples

1.  **Viewing the Reflog:**
    ```sh
    git reflog
    ```
    Output example:
    ```
    a1b2c3d HEAD@{0}: checkout: moving from main to feature/new-ui
    e4f5g6h HEAD@{1}: commit: Added new feature
    i7j8k9l HEAD@{2}: reset: moving to HEAD~1
    ```

2.  **Recovering a Deleted Branch:**
    Imagine you deleted a branch `my-feature` that had commits you didn't want to lose.
    *   First, view the reflog to find the commit hash of the last commit on `my-feature`. Let's say it's `i7j8k9l`.
    *   Then, create a new branch from that commit:
        ```sh
        git checkout -b my-feature i7j8k9l
        ```

3.  **Resetting to a Previous State:**
    Suppose you made several commits and want to go back to an earlier commit (`e4f5g6h` in the example above).
    ```sh
    git reset --hard e4f5g6h
    ```
    *   **Caution:** This discards all commits after `e4f5g6h` on the current branch. `reflog` can help recover from this.

### Interview Questions

1.  **What is `git reflog` and why is it important for an SDE?**
    *   **Answer:** `git reflog` is a local record of all changes made to your repository's references (like `HEAD` and branch tips). It acts as a crucial safety net, allowing you to recover lost commits, revert accidental resets or branch deletions, and navigate your repository's history when normal Git commands might not suffice. It's vital for debugging and recovering from common development mistakes without losing work.

2.  **How would you recover a commit that you accidentally deleted (e.g., via `git reset --hard`)?**
    *   **Answer:** I would first use `git reflog` to inspect the history of operations. I'd look for the commit hash associated with the action that led to the loss (e.g., a `reset` or `checkout`). Once I've identified the correct commit hash, I could either check it out directly (`git checkout <commit-hash>`) to inspect it, or create a new branch from it (`git branch <new-branch-name> <commit-hash>`) to continue working from that point.

3.  **What is the difference between `git reflog` and `git log`? When would you use one over the other?**
    *   **Answer:** `git log` shows the committed history of a branch â€“ the sequence of commits that form the linear or branched history of the project. It's what you see when you want to understand the evolution of your codebase. `git reflog`, on the other hand, tracks *all* movements of `HEAD` and other local references, including operations that don't result in new commits or that are "rewritten" history (like `reset`, `rebase`). You use `git log` for understanding project history and `git reflog` for recovering from mistakes or understanding local operations that aren't part of the main commit history.

4.  **Can `git reflog` help recover commits from a detached HEAD state?**
    *   **Answer:** Yes, `git reflog` can be instrumental. If you were in a detached HEAD state and made commits, and then accidentally moved `HEAD` to a different branch or commit without saving those new commits, `git reflog` would likely still contain entries pointing to the SHA of those detached HEAD commits. You could then use these reflog entries to recreate a branch pointing to those lost commits.